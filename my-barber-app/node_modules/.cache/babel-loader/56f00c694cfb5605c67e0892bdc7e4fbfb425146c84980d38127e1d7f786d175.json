{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\osaze\\\\OneDrive - Maynooth University\\\\Documents\\\\barberProject\\\\barberProject\\\\barberProject\\\\my-barber-app\\\\src\\\\pages\\\\TimeBook.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { collection, getDocs, doc, updateDoc } from \"firebase/firestore\";\nimport { db } from \"./firebase\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport \"./TimeBook.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction TimeBook() {\n  _s();\n  const [timeslots, setTimeslots] = useState([]);\n  const [selectedSlot, setSelectedSlot] = useState(null);\n  const navigate = useNavigate();\n  const {\n    state\n  } = useLocation();\n  useEffect(() => {\n    const fetchTimeslots = async () => {\n      try {\n        const querySnapshot = await getDocs(collection(db, \"timeslots\"));\n        let allSlots = [];\n        querySnapshot.forEach(docSnap => {\n          const data = docSnap.data();\n          if (data.slots) {\n            const slotsWithDate = data.slots.map(slot => ({\n              ...slot,\n              date: docSnap.id\n            }));\n            allSlots = [...allSlots, ...slotsWithDate];\n          }\n        });\n        setTimeslots(allSlots);\n      } catch (err) {\n        console.error(\"Error fetching timeslots:\", err);\n      }\n    };\n    fetchTimeslots();\n  }, []);\n\n  // Group slots by date\n  const groupedByDate = timeslots.reduce((acc, slot) => {\n    if (!slot.booked) {\n      if (!acc[slot.date]) acc[slot.date] = [];\n      acc[slot.date].push(slot);\n    }\n    return acc;\n  }, {});\n  const handleBook = async slot => {\n    try {\n      const docRef = doc(db, \"timeslots\", slot.date);\n      const updatedSlots = timeslots.filter(s => s.date === slot.date).map(s => s.time === slot.time ? {\n        ...s,\n        booked: true\n      } : s);\n      await updateDoc(docRef, {\n        slots: updatedSlots\n      });\n      alert(`Booked ${slot.date} at ${slot.time} ✅`);\n      setSelectedSlot(null);\n    } catch (err) {\n      console.error(\"Error booking slot:\", err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"timebook-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Available Times\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Your final total is $\", state.total, \". Please choose from one of the times below!\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"back-btn\",\n      onClick: () => navigate(\"/Booking\"),\n      children: \"Back\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), Object.keys(groupedByDate).map(date => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"timeslot-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: date\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 11\n      }, this), groupedByDate[date].map((slot, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `timeslot-btn ${selectedSlot === slot ? \"selected\" : \"\"}`,\n        onClick: () => setSelectedSlot(slot),\n        children: slot.time\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 13\n      }, this))]\n    }, date, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this)), selectedSlot && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\u2705 You selected: \", selectedSlot.date, \" at \", selectedSlot.time]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Click proceed to book your slot!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"proceed-btn\",\n      disabled: !selectedSlot,\n      onClick: async () => {\n        await handleBook(selectedSlot);\n        navigate(\"/payment\", {\n          state: {\n            total: state.total,\n            slot: selectedSlot\n          }\n        });\n      },\n      children: \"Proceed\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n}\n_s(TimeBook, \"cFtPgnxnNXgSL0yw39Szm+gfTdw=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = TimeBook;\nexport default TimeBook;\nvar _c;\n$RefreshReg$(_c, \"TimeBook\");","map":{"version":3,"names":["React","useEffect","useState","collection","getDocs","doc","updateDoc","db","useLocation","useNavigate","jsxDEV","_jsxDEV","TimeBook","_s","timeslots","setTimeslots","selectedSlot","setSelectedSlot","navigate","state","fetchTimeslots","querySnapshot","allSlots","forEach","docSnap","data","slots","slotsWithDate","map","slot","date","id","err","console","error","groupedByDate","reduce","acc","booked","push","handleBook","docRef","updatedSlots","filter","s","time","alert","className","children","fileName","_jsxFileName","lineNumber","columnNumber","total","onClick","Object","keys","index","disabled","_c","$RefreshReg$"],"sources":["C:/Users/osaze/OneDrive - Maynooth University/Documents/barberProject/barberProject/barberProject/my-barber-app/src/pages/TimeBook.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { collection, getDocs, doc, updateDoc } from \"firebase/firestore\";\r\nimport { db } from \"./firebase\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport \"./TimeBook.css\";\r\n\r\nfunction TimeBook() {\r\n  const [timeslots, setTimeslots] = useState([]);\r\n  const [selectedSlot, setSelectedSlot] = useState(null);\r\n  const navigate = useNavigate();\r\n  const { state } = useLocation();\r\n\r\n  useEffect(() => {\r\n    const fetchTimeslots = async () => {\r\n      try {\r\n        const querySnapshot = await getDocs(collection(db, \"timeslots\"));\r\n        let allSlots = [];\r\n        querySnapshot.forEach(docSnap => {\r\n          const data = docSnap.data();\r\n          if (data.slots) {\r\n            const slotsWithDate = data.slots.map(slot => ({\r\n              ...slot,\r\n              date: docSnap.id\r\n            }));\r\n            allSlots = [...allSlots, ...slotsWithDate];\r\n          }\r\n        });\r\n        setTimeslots(allSlots);\r\n      } catch (err) {\r\n        console.error(\"Error fetching timeslots:\", err);\r\n      }\r\n    };\r\n    fetchTimeslots();\r\n  }, []);\r\n\r\n  // Group slots by date\r\n  const groupedByDate = timeslots.reduce((acc, slot) => {\r\n    if (!slot.booked) {\r\n      if (!acc[slot.date]) acc[slot.date] = [];\r\n      acc[slot.date].push(slot);\r\n    }\r\n    return acc;\r\n  }, {});\r\n\r\n  const handleBook = async (slot) => {\r\n    try {\r\n      const docRef = doc(db, \"timeslots\", slot.date);\r\n      const updatedSlots = timeslots\r\n        .filter(s => s.date === slot.date)\r\n        .map(s => s.time === slot.time ? { ...s, booked: true } : s);\r\n      await updateDoc(docRef, { slots: updatedSlots });\r\n      alert(`Booked ${slot.date} at ${slot.time} ✅`);\r\n      setSelectedSlot(null);\r\n    } catch (err) {\r\n      console.error(\"Error booking slot:\", err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"timebook-container\">\r\n      <h2>Available Times</h2>\r\n      <hr />\r\n      <p>Your final total is ${state.total}. Please choose from one of the times below!</p>\r\n\r\n      <button className=\"back-btn\" onClick={() => navigate(\"/Booking\")}>Back</button>\r\n\r\n      {Object.keys(groupedByDate).map(date => (\r\n        <div key={date} className=\"timeslot-group\">\r\n          <h3>{date}</h3>\r\n          {groupedByDate[date].map((slot, index) => (\r\n            <button\r\n              key={index}\r\n              className={`timeslot-btn ${selectedSlot === slot ? \"selected\" : \"\"}`}\r\n              onClick={() => setSelectedSlot(slot)}\r\n            >\r\n              {slot.time}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      ))}\r\n\r\n      {selectedSlot && (\r\n        <p>✅ You selected: {selectedSlot.date} at {selectedSlot.time}</p>\r\n      )}\r\n\r\n      <p>Click proceed to book your slot!</p>\r\n\r\n      <button\r\n        className=\"proceed-btn\"\r\n        disabled={!selectedSlot}\r\n        onClick={async () => {\r\n          await handleBook(selectedSlot);\r\n          navigate(\"/payment\", { state: { total: state.total, slot: selectedSlot } });\r\n        }}\r\n      >\r\n        Proceed\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TimeBook;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}